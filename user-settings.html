<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Settings | Bitforex Academy</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#0b1220;color:#fff;}
.topbar{background:#020617;padding:15px;border-bottom:1px solid #1e293b;}
.content{padding:20px;padding-bottom:80px;}
input,button{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:6px;
  border:none;
}
button{background:#22c55e;font-weight:bold;}
.logout{background:red;color:#fff;}
.bottom-nav{
  position:fixed;bottom:0;width:100%;height:60px;
  background:#020617;display:flex;justify-content:space-around;
  align-items:center;border-top:1px solid #1e293b;
}
.bottom-nav a{color:#22c55e;text-decoration:none;font-size:12px;text-align:center;}
</style>
</head>

<body>

<div class="topbar">âš™ï¸ Settings</div>

<div class="content">
  <input id="username" placeholder="Username">
  <input id="email" placeholder="Email">
  <input type="password" id="newPass" placeholder="New Password">
  <button onclick="updateProfile()">Submit</button>
  <button class="logout" onclick="logout()">Logout</button>
</div>

<div class="bottom-nav">
  <a href="user-chat.html">ğŸ’¬<br>Chat</a>
  <a href="user-subscription.html">ğŸ’³<br>Subs</a>
  <a href="user-courses.html">ğŸ“˜<br>Courses</a>
  <a href="user-settings.html">âš™ï¸<br>Settings</a>
</div>

<!-- Firebase -->
<script type="module" src="firebase.js"></script>

<script type="module">
import { auth } from "./firebase.js";
import {
  updateProfile,
  updateEmail,
  updatePassword,
  signOut,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

/* Load user data */
onAuthStateChanged(auth, user=>{
  if(!user) location.href="login.html";
  username.value = user.displayName || "";
  email.value = user.email || "";
});

/* Update profile */
window.updateProfile = async ()=>{
  const user = auth.currentUser;
  if(!user) return;

  try{
    if(username.value){
      await updateProfile(user,{displayName:username.value});
    }

    if(email.value !== user.email){
      await updateEmail(user,email.value);
    }

    if(newPass.value.length >= 6){
      await updatePassword(user,newPass.value);
    }

    alert("Profile updated successfully");
    newPass.value="";
  }catch(err){
    alert(err.message);
  }
};

/* Logout */
window.logout = async ()=>{
  await signOut(auth);
  location.href="login.html";
};
</script>

</body>
</html>